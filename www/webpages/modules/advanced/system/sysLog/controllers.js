!function(a){a.su.moduleManager.define("sysLog",{models:["sysLogModel","saveLogModel"],stores:["logTypeStore","frequencyStore","sysLogStore"],services:["ajax","time"],views:["sysLogView"],listeners:{"ev_on_launch":function(e,o,t,n,s,i,g){this.unRegisterAutoSaveData([n.sysLogModel,n.saveLogModel]),"ios"===a.su.platform&&t.sysLogView.sysLogSaveLocal.hide(),s.logTypeStore.load(),n.sysLogModel.level.setValue(5),this.filterLog(5),g.time.on("on_time_change",o.onTimeChange)},"ev_before_destroy":function(e,o){o.beforeDestroy()}},init:function(n,e,o,t,s,i){this.configViews({id:"sysLogView",items:[{id:"system-log-information",configs:{convert:function(e){return e.content}}}]}),this.listen({"models.sysLogModel.level":{"ev_value_change":function(e,o,t){this.filterLog(o)}}}),this.control({"#save-local-btn":{"ev_button_click":function(){n.saveLog()}},"#system-log-information":{"ev_grid_paging_changed":function(e,o,t){o!==n.currentPage&&n.getSyslogPage(o)},"ev_refresh":function(){var e=o.sysLogModel.level.getValue();this.filterLog(e)}}})}},function(n,s,o,i,e,g){return{saveEmailFlag:!1,currentPage:0,getSyslogPage:function(t){i.sysLogStore.load({data:{index:t,limit:100},success:function(e,o){n.currentPage=t,i.sysLogStore.getPlugin("informationPaging").setTotalPage(e.totalNum,{currentPage:e.currentIndex,currentPageSize:100})}})},saveLog:function(){g.ajax.upload({proxy:"saveLogProxy",fileId:"save-log-file"})},filterLog:function(e){o.sysLogModel.submit({preventSuccessEvent:!0,success:function(){n.getSyslogPage(0)}})},onTimeChange:function(e,o){var t=g.time.getHour24(),n=g.time.format(o,null,t);s.sysLogView.currentTime.setValue(n)},beforeDestroy:function(){g.time.off("on_time_change",n.onTimeChange)}}})}(jQuery);