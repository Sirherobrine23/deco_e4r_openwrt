!function(a){a.su.moduleManager.define("reboot",{services:["ajax","device","time"],deps:["main"],stores:["rebootListStore"],views:["rebootView"],listeners:{"ev_on_launch":function(e,t,o,n,s,c,a){s.rebootListStore.load()}},init:function(n,e,t,s,c,o){this.configViews({id:"rebootView",items:[{id:"reboot-list-grid",configs:{minLines:0,columns:[{text:a.su.CHAR.FIRMWARE.TYPE,dataIndex:"deviceModel",renderer:function(e){var t,o;switch(e){case"M1300":case"M5":case"M9Plus":case"P7":t="icon-device-m5";break;case"M4":case"E4":case"W2400":case"M3":case"E3":case"M4R":case"AC1200":t="icon-device-m4r";break;case"M3W":t="icon-device-m3w";break;case"X20":case"X60":t="icon-device-x20";break;default:t="icon-device-m5"}return o='<a href="javascript:void(0)" class="grid-content-btn" style=\'cursor: default\'>',o+="<span class='icon-device "+t+"'></span>",o+="</a>"}},{text:a.su.CHAR.FIRMWARE.DEVICE_NAME,dataIndex:"nickname",renderer:function(e,t){var o="";return"disconnected"===t.groupStatus&&(o="("+a.su.CHAR.REBOOT.OFFLINE+")"),"custom"!==e?a.su.escapeHtml(e)+o:a.su.escapeHtml(a.su.b64Decode(t.customNickname))+o}},{text:a.su.CHAR.FIRMWARE.MODEL,dataIndex:"deviceModel"},{xtype:"actioncolumn",text:a.su.CHAR.REBOOT.REBOOT,renderer:function(e){return'<span class="icon"></span>','<span class="text"></span>',"</a>",'<a href="javascript:void(0)" class="grid-content-btn grid-content-btn-reboot btn-reboot"><span class="icon"></span><span class="text"></span></a>'}}]}}]}),this.listen({"stores.rebootListStore":{"ev_loaded":function(){for(var e=s.rebootListStore.getData(),t=e.length-1;0<=t;t--)"disconnected"===e[t].groupStatus?s.rebootListStore.disable(e[t].key):n.deviceArr.push({mac:e[t].mac})}}}),this.control({"#reboot-button":{"ev_button_click":function(){c.main.confirm(a.su.CHAR.REBOOT.REBOOT_ALERT,function(){n.startReboot(n.deviceArr)},null,a.su.CHAR.REBOOT.REBOOT)}},"#reboot-list-grid=>.grid-content-btn-reboot":{"ev_grid_action_click":function(e,t){var o=s.rebootListStore.getSubModelBindByKey(t).mac.getValue();c.main.confirm(a.su.CHAR.REBOOT.REBOOT_ALERT,function(){n.startReboot([{mac:o}])},null,a.su.CHAR.REBOOT.REBOOT)}}})}},function(e,t,o,n,s,c){return{deviceArr:[],startReboot:function(e){c.ajax.request({proxy:"rebootProxy",data:{"params":{"mac_list":e}},success:function(e){s.main.startReboot(115e3,function(){localStorage&&localStorage.setItem("token",""),location.href="https://tplinkdeco.net"})}})}}})}(jQuery);